
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>filters.python &mdash; pdal.io</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/pdal.css" type="text/css" />
      <link rel="stylesheet" href="../_static/breathe.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="canonical" href="https://pdal.io/stages/filters.python.html"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="filters.julia" href="filters.julia.html" />
    <link rel="prev" title="filters.matlab" href="filters.matlab.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
          </a>
              <div class="version">
                2.6.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../download.html">Download</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../apps/index.html">Applications</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../community.html">Community</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pipeline.html">Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="stages.html">Stages</a></li>
<li class="toctree-l1"><a class="reference internal" href="readers.html">Readers</a></li>
<li class="toctree-l1"><a class="reference internal" href="writers.html">Writers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="filters.html">Filters</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="filters.html#create">Create</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html#order">Order</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html#move">Move</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html#cull">Cull</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html#new">New</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html#join">Join</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html#metadata">Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html#mesh">Mesh</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="filters.html#languages">Languages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="filters.matlab.html">filters.matlab</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">filters.python</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modification-example">Modification Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#predicates">Predicates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-globals">Module Globals</a></li>
<li class="toctree-l4"><a class="reference internal" href="#options">Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="filters.julia.html">filters.julia</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="filters.html#other">Other</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dimensions.html">Dimensions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../types.html">Types</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python.html">Python</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../java.html">Java</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorials</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../workshop/index.html">Workshop</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project/index.html">Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">License</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PDAL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html"> Documentation </a> &raquo;</li>
      
          <li><a href="filters.html">Filters</a> &raquo;</li>
      
      <li>filters.python</li>
    

    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/PDAL/PDAL/edit//master/doc/stages/filters.python.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="filters.julia.html" class="btn btn-neutral float-right" title="filters.julia" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="filters.matlab.html" class="btn btn-neutral float-left" title="filters.matlab" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="filters-python">
<span id="id1"></span><h1>filters.python<a class="headerlink" href="#filters-python" title="Permalink to this heading"></a></h1>
<p>The <strong>Python Filter</strong> allows <a class="reference external" href="http://python.org/">Python</a> software to be embedded in a
<a class="reference internal" href="../pipeline.html#pipeline"><span class="std std-ref">Pipeline</span></a> that allows modification of PDAL points through a <a class="reference external" href="http://www.numpy.org/">NumPy</a>
array.  Additionally, some global <a class="reference internal" href="../development/metadata.html#metadata"><span class="std std-ref">Metadata</span></a> is also
available that Python functions can interact with.</p>
<p>The function must have two <a class="reference external" href="http://www.numpy.org/">NumPy</a> arrays as arguments, <code class="docutils literal notranslate"><span class="pre">ins</span></code> and <code class="docutils literal notranslate"><span class="pre">outs</span></code>.
The <code class="docutils literal notranslate"><span class="pre">ins</span></code> array represents the points before the <code class="docutils literal notranslate"><span class="pre">filters.python</span></code>
filter and the <code class="docutils literal notranslate"><span class="pre">outs</span></code> array represents the points after filtering.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure <a class="reference external" href="http://www.numpy.org/">NumPy</a> is installed in your <a class="reference external" href="http://python.org/">Python</a> environment.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import numpy; print(numpy.__version__)&quot;</span>
<span class="m">1</span>.18.1
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Each array contains all the <a class="reference internal" href="../dimensions.html#dimensions"><span class="std std-ref">Dimensions</span></a> of the incoming <code class="docutils literal notranslate"><span class="pre">ins</span></code>
point schema.  Each array in the <code class="docutils literal notranslate"><span class="pre">outs</span></code> list matches the <a class="reference external" href="http://www.numpy.org/">NumPy</a>
array of the same type as provided as <code class="docutils literal notranslate"><span class="pre">ins</span></code> for shape and type.</p>
</div>
<div class="admonition plugin" id="plugin-0">
<p class="admonition-title">Dynamic Plugin</p>
<p>This stage requires a dynamic plugin to operate</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">multiply_z</span><span class="p">(</span><span class="n">ins</span><span class="p">,</span><span class="n">outs</span><span class="p">):</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">ins</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span> <span class="o">*</span> <span class="mf">10.0</span>
    <span class="n">outs</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Z</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
<ol class="arabic">
<li><p>The function must always return <cite>True</cite> upon success. If the function
returned <cite>False</cite>, an error would be thrown and the <a class="reference internal" href="../pipeline.html#pipeline"><span class="std std-ref">Pipeline</span></a> exited.</p></li>
<li><p>If you want write a dimension that might not be available, you can specify
it with the <a class="reference internal" href="#add-dimension">add_dimension</a> option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;add_dimension&quot;</span><span class="p">:</span> <span class="s2">&quot;NewDimensionOne&quot;</span>
</pre></div>
</div>
<p>To create more than one dimension, this option also accepts an array:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;add_dimension&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;NewDimensionOne&quot;</span><span class="p">,</span> <span class="s2">&quot;NewDimensionTwo&quot;</span><span class="p">,</span> <span class="s2">&quot;NewDimensionThree&quot;</span> <span class="p">]</span>
</pre></div>
</div>
<p>You can also specify the <a class="reference internal" href="../types.html#types"><span class="std std-ref">type</span></a> of the dimension using an <code class="docutils literal notranslate"><span class="pre">=</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;add_dimension&quot;</span><span class="p">:</span> <span class="s2">&quot;NewDimensionOne=uint8&quot;</span>
</pre></div>
</div>
</li>
</ol>
<section id="modification-example">
<h2>Modification Example<a class="headerlink" href="#modification-example" title="Permalink to this heading"></a></h2>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;file-input.las&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;filters.smrf&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;filters.python&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;script&quot;</span><span class="p">:</span><span class="s2">&quot;multiply_z.py&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="s2">&quot;multiply_z&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="s2">&quot;anything&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;writers.las&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;filename&quot;</span><span class="p">:</span><span class="s2">&quot;file-filtered.las&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>The JSON pipeline file referenced the external <cite>multiply_z.py</cite> <a class="reference external" href="http://python.org/">Python</a> script,
which scales the <code class="docutils literal notranslate"><span class="pre">Z</span></code> coordinate by a factor of 10.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">multiply_z</span><span class="p">(</span><span class="n">ins</span><span class="p">,</span><span class="n">outs</span><span class="p">):</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">ins</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span> <span class="o">*</span> <span class="mf">10.0</span>
    <span class="n">outs</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Z</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
</section>
<section id="predicates">
<h2>Predicates<a class="headerlink" href="#predicates" title="Permalink to this heading"></a></h2>
<p>Points can be retained/removed from the stream by setting true/false values
into a special “Mask” dimension in the output point array.</p>
<p>The example above sets the “mask” to true for points that are in
classifications 1 or 2 and to false otherwise, causing points that are not
classified 1 or 2 to be dropped from the point stream.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="n">ins</span><span class="p">,</span><span class="n">outs</span><span class="p">):</span>
   <span class="bp">cls</span> <span class="o">=</span> <span class="n">ins</span><span class="p">[</span><span class="s1">&#39;Classification&#39;</span><span class="p">]</span>

   <span class="n">keep_classes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

   <span class="c1"># Use the first test for our base array.</span>
   <span class="n">keep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">keep_classes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

   <span class="c1"># For 1:n, test each predicate and join back</span>
   <span class="c1"># to our existing predicate array</span>
   <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">keep_classes</span><span class="p">)):</span>
       <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">keep_classes</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
       <span class="n">keep</span> <span class="o">=</span> <span class="n">keep</span> <span class="o">+</span> <span class="n">t</span>

   <span class="n">outs</span><span class="p">[</span><span class="s1">&#39;Mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">keep</span>
   <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="filters.range.html#filters-range"><span class="std std-ref">filters.range</span></a> is a specialized filter that implements the exact
functionality described in this Python operation. It is likely to be much
faster than Python, but not as flexible. <a class="reference internal" href="#filters-python"><span class="std std-ref">filters.python</span></a> is the tool
you can use for prototyping point stream processing operations.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>If you want to read a <a class="reference internal" href="../pipeline.html#pipeline"><span class="std std-ref">Pipeline</span></a> of operations into a numpy
array, the <a class="reference external" href="https://pypi.python.org/pypi/PDAL">PDAL Python extension</a>
is available.</p>
</div>
<section id="example-pipeline">
<h3>Example pipeline<a class="headerlink" href="#example-pipeline" title="Permalink to this heading"></a></h3>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;file-input.las&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;filters.smrf&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;filters.python&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;script&quot;</span><span class="p">:</span><span class="s2">&quot;filter_pdal.py&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="s2">&quot;filter&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="s2">&quot;anything&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;writers.las&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;filename&quot;</span><span class="p">:</span><span class="s2">&quot;file-filtered.las&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="module-globals">
<h2>Module Globals<a class="headerlink" href="#module-globals" title="Permalink to this heading"></a></h2>
<p>Three global variables are added to the Python module as it is run to allow
you to get <a class="reference internal" href="../dimensions.html#dimensions"><span class="std std-ref">Dimensions</span></a>, <a class="reference internal" href="../development/metadata.html#metadata"><span class="std std-ref">Metadata</span></a>, and coordinate system
information.
Additionally, the <code class="docutils literal notranslate"><span class="pre">metadata</span></code> object can be set by the function
to modify metadata
for the in-scope <a class="reference internal" href="#filters-python"><span class="std std-ref">filters.python</span></a> <a class="reference internal" href="../api/cpp/stage.html#_CPPv4N4pdal5StageE" title="pdal::Stage"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">pdal::Stage</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">myfunc</span><span class="p">(</span><span class="n">ins</span><span class="p">,</span><span class="n">outs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;schema: &#39;</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;srs: &#39;</span><span class="p">,</span> <span class="n">spatialreference</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;metadata: &#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>
    <span class="n">outs</span> <span class="o">=</span> <span class="n">ins</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
<section id="setting-stage-metadata">
<h3>Setting stage metadata<a class="headerlink" href="#setting-stage-metadata" title="Permalink to this heading"></a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The name of the output metadata variable has changed from <code class="docutils literal notranslate"><span class="pre">metadata</span></code> to <code class="docutils literal notranslate"><span class="pre">out_metadata</span></code>.</p>
</div>
<p>Stage metadata can be created by using the <code class="docutils literal notranslate"><span class="pre">out_metadata</span></code> dictionary <strong>global</strong> variable.
The <code class="docutils literal notranslate"><span class="pre">name</span></code> key must be set. The type of the <code class="docutils literal notranslate"><span class="pre">value</span></code> can usually be inferred, but
can be set to one of <code class="docutils literal notranslate"><span class="pre">integer</span></code>, <code class="docutils literal notranslate"><span class="pre">nonNegativeInteger</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code>, <code class="docutils literal notranslate"><span class="pre">bounds</span></code>,
<code class="docutils literal notranslate"><span class="pre">boolean</span></code>, <code class="docutils literal notranslate"><span class="pre">spatialreference</span></code>, <code class="docutils literal notranslate"><span class="pre">uuid</span></code> or <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p>
<p>Children may be set using the <code class="docutils literal notranslate"><span class="pre">children</span></code> key whose value is a list of dictionaries.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">myfunc</span><span class="p">(</span><span class="n">ins</span><span class="p">,</span><span class="n">outs</span><span class="p">):</span>
  <span class="k">global</span> <span class="n">out_metadata</span>
  <span class="n">out_metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;a string&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;a description&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;somekey&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">52</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;a filter description&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">:</span> <span class="p">[]},</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;readers.faux&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;another string&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;a reader description&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">:</span> <span class="p">[]}]}</span>
  <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
</section>
<section id="passing-python-objects">
<h3>Passing Python objects<a class="headerlink" href="#passing-python-objects" title="Permalink to this heading"></a></h3>
<p>An JSON-formatted option can be passed to the filter representing a
Python dictionary containing objects you want to use in your function.
This feature is useful in situations where you
wish to call <a class="reference internal" href="../apps/pipeline.html#pipeline-command"><span class="std std-ref">pipeline</span></a> with substitutions.</p>
<p>If we needed to be able to provide the Z scaling factor of <a class="reference internal" href="#example-pipeline">Example Pipeline</a>
with a
Python argument, we can place that in a dictionary and pass that to the filter
as a separate argument. This feature allows us to be able easily reuse the same
basic Python function while substituting values as necessary.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;input.las&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;filters.python&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="s2">&quot;anything&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="s2">&quot;filter&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;script&quot;</span><span class="p">:</span><span class="s2">&quot;arguments.py&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;pdalargs&quot;</span><span class="p">:</span><span class="s2">&quot;{\&quot;factor\&quot;:0.3048,\&quot;an_argument\&quot;:42, \&quot;another\&quot;: \&quot;a string\&quot;}&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="s2">&quot;output.las&quot;</span>
<span class="p">]</span>
</pre></div>
</div>
<p>With that option set, you can now fetch the <a class="reference internal" href="#pdalargs">pdalargs</a> dictionary in your
Python script and use it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">multiply_z</span><span class="p">(</span><span class="n">ins</span><span class="p">,</span><span class="n">outs</span><span class="p">):</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">ins</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">pdalargs</span><span class="p">[</span><span class="s1">&#39;factor&#39;</span><span class="p">])</span>
    <span class="n">outs</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Z</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
</section>
<section id="standard-output-and-error">
<h3>Standard output and error<a class="headerlink" href="#standard-output-and-error" title="Permalink to this heading"></a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">redirector</span></code> module is available for scripts to output to PDAL’s log stream
explicitly. The module handles redirecting <code class="docutils literal notranslate"><span class="pre">sys.stderr</span></code> and
<code class="docutils literal notranslate"><span class="pre">sys.stdout</span></code> for you
transparently, but it can be used directly by scripts. See the PDAL source
code for more details.</p>
</section>
</section>
<section id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>script</dt><dd><p>When reading a function from a separate <a class="reference external" href="http://python.org/">Python</a> file, the file name to read
from.</p>
</dd>
<dt>source</dt><dd><p>The literal <a class="reference external" href="http://python.org/">Python</a> code to execute, when the script option is
not being used.</p>
</dd>
<dt>module</dt><dd><p>The Python module that is holding the function to run. [Required]</p>
</dd>
<dt>function</dt><dd><p>The function to call. [Required]</p>
</dd>
<dt><span class="target" id="add-dimension">add_dimension</span></dt><dd><p>A dimension name or an array of dimension names to add to the pipeline that do not already exist.</p>
</dd>
<dt><span class="target" id="pdalargs">pdalargs</span></dt><dd><p>A JSON dictionary of items you wish to pass into the modules globals as the
<code class="docutils literal notranslate"><span class="pre">pdalargs</span></code> object.</p>
</dd>
</dl>
<dl class="simple">
<dt>where</dt><dd><p>An <a class="reference internal" href="expression.html#pdal-expression"><span class="std std-ref">expression</span></a> that limits points passed to a filter.
Points that don’t pass the
expression skip the stage but are available to subsequent stages in a pipeline.
[Default: no filtering]</p>
</dd>
<dt>where_merge</dt><dd><p>A strategy for merging points skipped by a ‘<cite>where’</cite> option when running in standard mode.
If <code class="docutils literal notranslate"><span class="pre">true</span></code>, the skipped points are added to the first point view returned by the skipped
filter. If <code class="docutils literal notranslate"><span class="pre">false</span></code>, skipped points are placed in their own point view. If <code class="docutils literal notranslate"><span class="pre">auto</span></code>,
skipped points are merged into the returned point view provided that only one point view
is returned and it has the same point count as it did when the filter was run.
[Default: <code class="docutils literal notranslate"><span class="pre">auto</span></code>]</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="filters.julia.html" class="btn btn-neutral float-right" title="filters.julia" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="filters.matlab.html" class="btn btn-neutral float-left" title="filters.matlab" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <div class="info">
      <a class="logo-link" href="https://hobu.co">
        <div class="hobu-logo"></div>
      </a>
      <div class="copyright">
      

                    &copy;  2023
                        <a href="https://github.com/abellgithub">Andrew Bell</a>,
                        <a href="https://github.com/chambbj">Brad Chambers</a>,
                        <a href="http://github.com/hobu">Howard Butler</a>,
                        and
                        <a href="https://github.com/PDAL/PDAL/graphs/contributors">others</a>.

      
      Last updated on May 22, 2023.
      </div>
    </div>
</footer>
        </div>
      </div>
    </section>
  </div>
  
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <div class="footer">
        <div class="container">
                    &copy;  2023
                        <a href="http://github.com/hobu">Howard Butler</a>,
                        <a href="http://github.com/mpgerlek">Michael Gerlek</a>,
                        and
                        <a href="https://github.com/PDAL/PDAL/graphs/contributors">others</a>,
                Last updated
                    on May 22, 2023.
        </div>
    </div>

</body>
</html>