
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>filters.cpd &mdash; pdal.io</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/pdal.css" type="text/css" />
      <link rel="stylesheet" href="../_static/breathe.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="canonical" href="https://pdal.io/stages/filters.cpd.html"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="filters.icp" href="filters.icp.html" />
    <link rel="prev" title="filters.sort" href="filters.sort.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
          </a>
              <div class="version">
                2.6.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../download.html">Download</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../apps/index.html">Applications</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../community.html">Community</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pipeline.html">Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="stages.html">Stages</a></li>
<li class="toctree-l1"><a class="reference internal" href="readers.html">Readers</a></li>
<li class="toctree-l1"><a class="reference internal" href="writers.html">Writers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="filters.html">Filters</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="filters.html#create">Create</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html#order">Order</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="filters.html#move">Move</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="filters.html#registration">Registration</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">filters.cpd</a></li>
<li class="toctree-l4"><a class="reference internal" href="filters.icp.html">filters.icp</a></li>
<li class="toctree-l4"><a class="reference internal" href="filters.teaser.html">filters.teaser</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="filters.html#predefined">Predefined</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="filters.html#cull">Cull</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html#new">New</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html#join">Join</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html#metadata">Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html#mesh">Mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html#languages">Languages</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html#other">Other</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dimensions.html">Dimensions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../types.html">Types</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python.html">Python</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../java.html">Java</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorials</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../workshop/index.html">Workshop</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project/index.html">Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">License</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PDAL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html"> Documentation </a> &raquo;</li>
      
          <li><a href="filters.html">Filters</a> &raquo;</li>
      
      <li>filters.cpd</li>
    

    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/PDAL/PDAL/edit//master/doc/stages/filters.cpd.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="filters.icp.html" class="btn btn-neutral float-right" title="filters.icp" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="filters.sort.html" class="btn btn-neutral float-left" title="filters.sort" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="filters-cpd">
<span id="id1"></span><h1>filters.cpd<a class="headerlink" href="#filters-cpd" title="Permalink to this heading"></a></h1>
<p>The <strong>Coherent Point Drift (CPD) filter</strong> uses the algorithm of
<span id="id2">[<a class="reference internal" href="#id5" title="Andriy Myronenko and Xubo Song. Point set registration: coherent point drift. IEEE transactions on pattern analysis and machine intelligence, 32(12):2262–75, dec 2010.">MS10</a>]</span> algorithm to
compute a rigid, nonrigid, or affine transformation between datasets.  The
rigid and affine are what you’d expect; the nonrigid transformation uses Motion
Coherence Theory <span id="id3">[<a class="reference internal" href="#id6" title="Alan L. Yuille and Norberto M. Grzywacz. The Motion Coherence Theory. Second International Conference on Computer Vision, 1988.">YG88</a>]</span> to “bend” the points to find a best
alignment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>CPD is computationally intensive and can be slow when working with many
points (i.e. &gt; 10,000).  Nonrigid is significantly slower
than rigid and affine.</p>
</div>
<p>The first input to the change filter are considered the “fixed” points, and all
subsequent inputs are “moving” points.  The output from the change filter are
the “moving” points after the calculated transformation has been applied, one
point view per input.  Any additional information about the cpd registration,
e.g. the rigid transformation matrix, will be placed in the stage’s metadata.</p>
<section id="when-to-use-cpd-vs-icp">
<h2>When to use CPD vs ICP<a class="headerlink" href="#when-to-use-cpd-vs-icp" title="Permalink to this heading"></a></h2>
<p>Summarized from the <a class="reference external" href="http://graphics.stanford.edu/courses/cs468-07-winter/Papers/nips2006_0613.pdf">Non-rigid point set registration: Coherent Point Drift</a> paper.</p>
<ul class="simple">
<li><p>CPD outperforms the ICP in the presence of noise and outliers by the use of
a probabilistic assignment of correspondences between pointsets, which is
innately more robust than the binary assignment used in ICP.</p></li>
<li><p>CPD does not work well for large in-plane rotation, such transformation can
be first compensated by other well known global registration techniques before
CPD algorithm is carried out</p></li>
<li><p>CPD is most effective when estimating smooth non-rigid transformations.</p></li>
</ul>
<div class="admonition plugin" id="plugin-0">
<p class="admonition-title">Dynamic Plugin</p>
<p>This stage requires a dynamic plugin to operate</p>
</div>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h2>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;fixed.las&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;moving.las&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;filters.cpd&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;method&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;rigid&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="s2">&quot;output.las&quot;</span>
<span class="p">]</span>
</pre></div>
</div>
<p>If <a class="reference internal" href="#method">method</a> is not provided, the cpd filter will default to using the
rigid registration method.  To get the transform matrix, you’ll need to
use the “metadata” option of the pipeline command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pdal pipeline cpd-pipeline.json --metadata cpd-metadata.json
</pre></div>
</div>
<p>The metadata output might start something like:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;stages&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;filters.cpd&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;iterations&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;method&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;rigid&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;runtime&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.003839</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;sigma2&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">5.684342128e-16</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;transform&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;           1 -6.21722e-17  1.30104e-18  5.29303e-11-8.99346e-17            1  2.60209e-18 -3.49247e-10 -2.1684e-19  1.73472e-18            1 -1.53477e-12           0            0            0            1&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">},</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="filters.transformation.html#filters-transformation"><span class="std std-ref">filters.transformation</span></a> to apply a transform to other points.
<a class="reference internal" href="filters.icp.html#filters-icp"><span class="std std-ref">filters.icp</span></a> for deterministic binary point pair assignments.</p>
</div>
</section>
<section id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt><span class="target" id="method">method</span></dt><dd><p>Change detection method to use.
Valid values are “rigid”, “affine”, and “nonrigid”.
[Default: “rigid””]</p>
</dd>
</dl>
<dl class="simple">
<dt>where</dt><dd><p>An <a class="reference internal" href="expression.html#pdal-expression"><span class="std std-ref">expression</span></a> that limits points passed to a filter.
Points that don’t pass the
expression skip the stage but are available to subsequent stages in a pipeline.
[Default: no filtering]</p>
</dd>
<dt>where_merge</dt><dd><p>A strategy for merging points skipped by a ‘<cite>where’</cite> option when running in standard mode.
If <code class="docutils literal notranslate"><span class="pre">true</span></code>, the skipped points are added to the first point view returned by the skipped
filter. If <code class="docutils literal notranslate"><span class="pre">false</span></code>, skipped points are placed in their own point view. If <code class="docutils literal notranslate"><span class="pre">auto</span></code>,
skipped points are merged into the returned point view provided that only one point view
is returned and it has the same point count as it did when the filter was run.
[Default: <code class="docutils literal notranslate"><span class="pre">auto</span></code>]</p>
</dd>
</dl>
<div class="docutils container" id="id4">
<div class="citation" id="id7" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>GM19<span class="fn-bracket">]</span></span>
<p>D. Gatziolis and R. J. McGaughey. Reconstructing aircraft trajectories from multi-return airborne laser-scanning data. <em>Remote Sensing</em>, 2019.</p>
</div>
<div class="citation" id="id8" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>LLW+19<span class="fn-bracket">]</span></span>
<p>Xuechen Li, Yinlong Liu, Yiru Wang, Chen Wang, Manning Wang, and Zhijian Song. Fast and Globally Optimal Rigid Registration of 3D Point Sets by Transformation Decomposition. <em>unknown</em>, 2019. Available at <a class="reference external" href="https://arxiv.org/pdf/1812.11307.pdf">https://arxiv.org/pdf/1812.11307.pdf</a>.</p>
</div>
<div class="citation" id="id5" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">MS10</a><span class="fn-bracket">]</span></span>
<p>Andriy Myronenko and Xubo Song. Point set registration: coherent point drift. <em>IEEE transactions on pattern analysis and machine intelligence</em>, 32(12):2262–75, dec 2010.</p>
</div>
<div class="citation" id="id6" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">YG88</a><span class="fn-bracket">]</span></span>
<p>Alan L. Yuille and Norberto M. Grzywacz. The Motion Coherence Theory. <em>Second International Conference on Computer Vision</em>, 1988.</p>
</div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="filters.icp.html" class="btn btn-neutral float-right" title="filters.icp" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="filters.sort.html" class="btn btn-neutral float-left" title="filters.sort" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <div class="info">
      <a class="logo-link" href="https://hobu.co">
        <div class="hobu-logo"></div>
      </a>
      <div class="copyright">
      

                    &copy;  2023
                        <a href="https://github.com/abellgithub">Andrew Bell</a>,
                        <a href="https://github.com/chambbj">Brad Chambers</a>,
                        <a href="http://github.com/hobu">Howard Butler</a>,
                        and
                        <a href="https://github.com/PDAL/PDAL/graphs/contributors">others</a>.

      
      Last updated on May 22, 2023.
      </div>
    </div>
</footer>
        </div>
      </div>
    </section>
  </div>
  
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <div class="footer">
        <div class="container">
                    &copy;  2023
                        <a href="http://github.com/hobu">Howard Butler</a>,
                        <a href="http://github.com/mpgerlek">Michael Gerlek</a>,
                        and
                        <a href="https://github.com/PDAL/PDAL/graphs/contributors">others</a>,
                Last updated
                    on May 22, 2023.
        </div>
    </div>

</body>
</html>